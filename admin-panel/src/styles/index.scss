// 导入变量和混入
@use './variables.scss' as *;
@use './mixins.scss' as *;

// 导入滚动表格样式
@use './scrollable-table.scss' as *;

// 导入 ProTable 样式
@use './protable.scss' as *;

// 导入列宽拖拽样式
@use './column-resize.scss' as *;

// NProgress 样式覆盖 - 更微妙的进度条
#nprogress {
  pointer-events: none;
  
  .bar {
    background: var(--el-color-primary) !important;
    position: fixed;
    z-index: 9999;
    top: 0;
    left: 0;
    width: 100%;
    height: 2px !important; // 更细的进度条
    box-shadow: 0 0 2px var(--el-color-primary);
  }
  
  // 移除peg（进度条末端的发光效果）
  .peg {
    display: none !important;
  }
  
  // 确保没有背景遮罩
  .spinner {
    display: none !important;
  }
}

// 移除任何可能的背景遮罩
#nprogress-background,
.nprogress-custom-parent {
  overflow: visible !important;
  position: relative !important;
  background: transparent !important; // 确保背景完全透明
}

// TailwindCSS
@tailwind base;
@tailwind components;
@tailwind utilities;

// 重置样式
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  width: 100%;
  height: 100%;
  font-size: 14px;
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  width: 100%;
  height: 100%;
  font-family: 'Helvetica Neue', Helvetica, 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', '微软雅黑', Arial, sans-serif;
  color: var(--el-text-color-primary);
  background-color: var(--content-bg-color, #f2f3f5); // 使用主题变量，fallback到浅色背景
  transition: background-color 0.3s ease, color 0.3s ease; // 平滑过渡
  overflow-x: hidden; // 防止水平滚动条
}

#app {
  width: 100%;
  height: 100%;
  background-color: var(--content-bg-color, #f2f3f5); // 使用主题变量
}

// 路由切换过渡期间的背景保障
.admin-layout {
  background-color: var(--content-bg-color, #f2f3f5) !important;
}

// 确保所有Vue过渡组件都有正确的背景
.v-enter-active,
.v-leave-active,
.v-enter-from,
.v-leave-to {
  background-color: var(--content-bg-color, #f2f3f5) !important;
}

// 链接样式
a {
  color: var(--el-color-primary);
  text-decoration: none;
  
  &:hover {
    color: var(--el-color-primary-light-3);
  }
}

// 图片样式
img {
  max-width: 100%;
  height: auto;
  vertical-align: middle;
}

// 列表样式
ul, ol {
  list-style: none;
}

// 表格样式
table {
  border-collapse: collapse;
  border-spacing: 0;
}

// 输入框样式
input, textarea, select, button {
  font-family: inherit;
  font-size: inherit;
}

// 按钮样式重置
button {
  border: none;
  background: none;
  cursor: pointer;
}

// 工具类
.text-center { text-align: center; }
.text-left { text-align: left; }
.text-right { text-align: right; }

.flex { display: flex; }
.flex-center { 
  display: flex; 
  align-items: center; 
  justify-content: center; 
}
.flex-between { 
  display: flex; 
  align-items: center; 
  justify-content: space-between; 
}
.flex-start { 
  display: flex; 
  align-items: center; 
  justify-content: flex-start; 
}
.flex-end { 
  display: flex; 
  align-items: center; 
  justify-content: flex-end; 
}

.w-full { width: 100%; }
.h-full { height: 100%; }

// 间距工具类
@for $i from 0 through 10 {
  .m-#{$i} { margin: #{$i * 4}px; }
  .mt-#{$i} { margin-top: #{$i * 4}px; }
  .mr-#{$i} { margin-right: #{$i * 4}px; }
  .mb-#{$i} { margin-bottom: #{$i * 4}px; }
  .ml-#{$i} { margin-left: #{$i * 4}px; }
  .mx-#{$i} { 
    margin-left: #{$i * 4}px; 
    margin-right: #{$i * 4}px; 
  }
  .my-#{$i} { 
    margin-top: #{$i * 4}px; 
    margin-bottom: #{$i * 4}px; 
  }
  
  .p-#{$i} { padding: #{$i * 4}px; }
  .pt-#{$i} { padding-top: #{$i * 4}px; }
  .pr-#{$i} { padding-right: #{$i * 4}px; }
  .pb-#{$i} { padding-bottom: #{$i * 4}px; }
  .pl-#{$i} { padding-left: #{$i * 4}px; }
  .px-#{$i} { 
    padding-left: #{$i * 4}px; 
    padding-right: #{$i * 4}px; 
  }
  .py-#{$i} { 
    padding-top: #{$i * 4}px; 
    padding-bottom: #{$i * 4}px; 
  }
}

// 文字颜色
.text-primary { color: var(--el-color-primary); }
.text-success { color: var(--el-color-success); }
.text-warning { color: var(--el-color-warning); }
.text-danger { color: var(--el-color-danger); }
.text-info { color: var(--el-color-info); }

// 主题色动态应用
:root {
  // 确保主题色变量生效
  --el-color-primary: var(--color-primary, #409eff);
  --el-color-primary-light-3: var(--color-primary-300, #79bbff);
  --el-color-primary-light-5: var(--color-primary-200, #a0cfff);
  --el-color-primary-light-7: var(--color-primary-100, #c6e2ff);
  --el-color-primary-light-8: var(--color-primary-50, #d9ecff);
  --el-color-primary-light-9: var(--color-primary-50, #ecf5ff);
  --el-color-primary-dark-2: var(--color-primary-600, #337ecc);
}

.text-regular { color: var(--el-text-color-regular); }
.text-secondary { color: var(--el-text-color-secondary); }
.text-placeholder { color: var(--el-text-color-placeholder); }

// 文字大小
.text-xs { font-size: 12px; }
.text-sm { font-size: 13px; }
.text-base { font-size: 14px; }
.text-lg { font-size: 16px; }
.text-xl { font-size: 18px; }
.text-2xl { font-size: 20px; }
.text-3xl { font-size: 20px; }

// 文字粗细
.font-light { font-weight: 300; }
.font-normal { font-weight: 400; }
.font-medium { font-weight: 500; }
.font-semibold { font-weight: 600; }
.font-bold { font-weight: 700; }

// 圆角
.rounded { border-radius: 4px; }
.rounded-md { border-radius: 6px; }
.rounded-lg { border-radius: 8px; }
.rounded-xl { border-radius: 8px; }
.rounded-full { border-radius: 50%; }

// 阴影
.shadow-sm { box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); }
.shadow { box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); }
.shadow-md { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
.shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }

// 过渡动画
.transition { transition: all 0.3s ease; }
.transition-fast { transition: all 0.15s ease; }
.transition-slow { transition: all 0.5s ease; }

// 悬停效果
.hover-scale:hover { transform: scale(1.05); }
.hover-shadow:hover { box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15); }

// 自定义组件样式
.page-container {
  min-height: calc(100vh - 60px); // 减去头部高度
}

.card-container {
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.08);
  margin-bottom: 20px;
}

// 响应式工具类
@media (max-width: 768px) {
  .hidden-mobile { display: none !important; }
}

@media (min-width: 769px) {
  .hidden-desktop { display: none !important; }
}

// 加载状态
.loading-container {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 200px;
  color: var(--el-text-color-secondary);
}

// 空状态
.empty-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 200px;
  color: var(--el-text-color-secondary);
  
  .empty-icon {
    font-size: 48px;
    margin-bottom: 16px;
    opacity: 0.5;
  }
  
  .empty-text {
    font-size: 16px;
    margin-bottom: 8px;
  }
  
  .empty-description {
    font-size: 14px;
    color: var(--el-text-color-placeholder);
  }
}

// 表格操作列
.table-actions {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0;
  
  .el-button + .el-button {
    margin-left: 6px;
  }
  
  // 文字按钮特殊样式
  .el-button.el-button--text {
    padding: 0 !important;
    margin: 0 2px !important;
    font-size: 13px !important;
  }
}

// 搜索表单
.search-form {
  background: white;
  padding: 20px;
  border-radius: 8px;
  margin-bottom: 20px;
  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.08);
  
  .search-actions {
    text-align: right;
    margin-top: 16px;
  }
}

// 统计卡片网格
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 20px;
  margin-bottom: 20px;
}

// 图表容器
.chart-container {
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.08);
  
  .chart-title {
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 16px;
    color: var(--el-text-color-primary);
  }
}

// 标签样式
.status-tag {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 12px;
  display: inline-block;
  
  &.active { 
    color: var(--el-color-success);
    background-color: var(--el-color-success-light-9);
    border: 1px solid var(--el-color-success-light-7);
  }
  &.inactive { 
    color: var(--el-color-info);
    background-color: var(--el-color-info-light-9);
    border: 1px solid var(--el-color-info-light-7);
  }
  &.suspended { 
    color: var(--el-color-warning);
    background-color: var(--el-color-warning-light-9);
    border: 1px solid var(--el-color-warning-light-7);
  }
  &.banned { 
    color: var(--el-color-danger);
    background-color: var(--el-color-danger-light-9);
    border: 1px solid var(--el-color-danger-light-7);
  }
}

// 头像样式
.user-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid var(--el-border-color-lighter);
}

// 操作按钮组
.action-buttons {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  
  .el-button {
    margin: 0;
  }
}

// 全局通知弹窗样式覆盖
.notification-popover.el-popover {
  padding: 0 !important;
  border-radius: 8px !important;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15) !important;
  border: 1px solid var(--el-border-color-light) !important;
  background: var(--el-bg-color) !important;
  max-height: 500px !important;
  overflow: hidden !important;
  z-index: 2000 !important;
  transform-origin: top right !important;
  
  // 入场动画
  &[data-popper-placement^="bottom"] {
    animation: notificationSlideDown 0.3s cubic-bezier(0.23, 1, 0.32, 1) forwards;
  }
  
  &.el-popper {
    min-width: 380px !important;
  }
  
  // 隐藏箭头
  .el-popper__arrow {
    display: none !important;
  }
  
  // 确保内容区域正确显示
  .el-popover__content {
    padding: 0 !important;
    margin: 0 !important;
  }
}

// 通知弹窗动画
@keyframes notificationSlideDown {
  0% {
    opacity: 0;
    transform: translateY(-8px) scale(0.95);
  }
  100% {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

// Element Plus Loading 组件样式覆盖
.el-loading-mask {
  background-color: var(--loading-bg-color, rgba(242, 243, 245, 0.9)) !important; // 使用主题变量
}

.el-loading-mask.is-fullscreen {
  background-color: var(--loading-bg-color, rgba(242, 243, 245, 0.95)) !important; // 使用主题变量
}

// 页面级loading样式覆盖
.page-loading {
  background-color: var(--content-bg-color, #f2f3f5) !important;
}

// 确保所有loading相关的容器都使用正确的背景色
[v-loading] {
  background-color: transparent !important;
}

.loading-container,
.el-loading-parent--relative {
  background-color: var(--content-bg-color, #f2f3f5) !important;
}